{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "$id": "https://example.org/schemas/l2i-capability-v0.json",
  "title": "L2I Capability Profile v0",
  "type": "object", "additionalProperties": false,
  "required": ["profile_id","queues","meters","multicast","atomic_commit","telemetry"],
  "properties": {
    "profile_id": { "type": "string", "minLength": 1 },
    "description": { "type": "string" },
    "queues": {
      "type": "object", "additionalProperties": false, "required": ["max_queues","modes"],
      "properties": {
        "max_queues": { "type": "integer", "minimum": 1 },
        "modes": {
          "type": "object", "additionalProperties": false, "required": ["strict","wfq"],
          "properties": {
            "strict": { "type": "boolean" },
            "wfq": {
              "type": "object", "additionalProperties": false,
              "required": ["supported","weights_min","weights_max"],
              "properties": {
                "supported": { "type": "boolean" },
                "weights_min": { "type": "number", "exclusiveMinimum": 0 },
                "weights_max": { "type": "number", "exclusiveMinimum": 0 }
              }
            }
          }
        }
      }
    },
    "meters": {
      "type": "object", "additionalProperties": false, "required": ["supported","types"],
      "properties": {
        "supported": { "type": "boolean" },
        "types": { "type": "array", "items": { "type": "string", "enum": ["tbf","trtcm"] }, "maxItems": 4 },
        "min_rate_mbps": { "type": "number", "exclusiveMinimum": 0 },
        "max_rate_mbps": { "type": "number", "exclusiveMinimum": 0 }
      }
    },
    "multicast": {
      "type": "object", "additionalProperties": false, "required": ["mode"],
      "properties": {
        "mode": { "type": "string", "enum": ["none","vlan_flood","l2mc_static"] },
        "max_groups": { "type": "integer", "minimum": 0 },
        "max_replications_per_group": { "type": "integer", "minimum": 0 }
      }
    },
    "ports": {
      "type": "array", "items": {
        "type": "object", "additionalProperties": false, "required": ["name","speed_mbps"],
        "properties": { "name": { "type": "string","minLength": 1 }, "speed_mbps": { "type": "integer","minimum": 10 } }
      }
    },
    "atomic_commit": { "type": "boolean" },
    "telemetry": {
      "type": "object","additionalProperties": false,
      "required": ["rtt_percentile","throughput_sustained","queue_occupancy","delivery_ratio"],
      "properties": {
        "rtt_percentile": { "type": "boolean" },
        "throughput_sustained": { "type": "boolean" },
        "queue_occupancy": { "type": "boolean" },
        "delivery_ratio": { "type": "boolean" }
      }
    }
  }
}